# theme(axis.text.x = element_text(angle=90))+
#    scale_y_continuous("Percent of Obligations", labels = percent_format(accuracy=1))+
#      facet_grid(.~Competition.sum ,scales="free_x", space="free_x"
#             )+labs(title=NULL,
# x="Fiscal Year",
# y="Percent of Obligations",
# color="Competition")+
theme(legend.position = "bottom")+
labs(y="Obligations (Constant 2021 $s)")+
facet_grid(SimpleArea~SubCustomer.JPO, scales = "free_y",space="free_y")
)
(
SubCustomerPSR<-build_plot(
data=engine_contracts %>% filter(
SubCustomer.JPO %in% c("Army","Navy","Air Force","DLA","F-35 JPO")),
chart_geom = "Bar Chart",
share = FALSE,
labels_and_colors=labels_and_colors,
# NA, #VAR.ncol
x_var="Fiscal_Year", #x_var
y_var="Action_Obligation_OMB23_GDP21", #VAR.y.variable
color_var="SimpleArea", #facet_var
facet_var="SimpleArea", #color_var
second_var="SubCustomer.JPO",
column_key=column_key,
format=TRUE,
ytextposition=FALSE
)+
# theme(strip.text.y = element_text(angle=0))+
# theme(axis.text.x = element_text(angle=90))+
#    scale_y_continuous("Percent of Obligations", labels = percent_format(accuracy=1))+
#      facet_grid(.~Competition.sum ,scales="free_x", space="free_x"
#             )+labs(title=NULL,
# x="Fiscal Year",
# y="Percent of Obligations",
# color="Competition")+
theme(legend.position = "bottom")+
labs(y="Obligations (Constant 2021 $s)")#+
# facet_grid(SimpleArea~SubCustomer.JPO, scales = "free_y",space="free_y")
)
ggsave600dpi("Charts//subcustomer_PSR.png", SubCustomerPSR,
width=9, height= 6, units="in",size=12,lineheight = 1.2
)
(
graph_contracts_overall <- comparison_contracts_overall %>% filter(Fiscal.Year>=2000),
(
graph_contracts_overall <- comparison_contracts_overall %>% filter(Fiscal.Year>=2000),
(
graph_contracts_overall_area <- comparison_contracts_area_total %>%
filter(!is.na(SimpleArea) & !SimpleArea %in% c("Unlabeled") &
Fiacal_Year>=1990 ) %>%
mutate(type = factor(type, levels = c("Topline", "Engines"))) %>%
ggplot() +
geom_line(
aes(x = Fiscal_Year,
y = baseline_percent_change,
linetype=SimpleArea),
alpha = .9,
color = "#554449",
size = 1
) +
geom_hline(
yintercept = 0,
alpha = .5,
color = "#554449",
size = .5,
linetype = "dotted"
) +
facet_wrap(~ type) +
chart_theme +
ggtitle("Change in Aircraft Engine Contract Obligations") +
xlab("Fiscal Year") +
ylab("Cumulative Percent Change, Inflation Adjusted (2000=0%)") +
scale_y_continuous(labels = scales::percent, breaks = c(-0.5,0,0.5,1,1.5)) +
scale_x_continuous(
breaks = seq(2000, 2020, by = 2),
labels = function(x) {
substring(as.character(x), 3, 4)
}
)+scale_linetype_manual(
values=c("solid","dotted","dashed")
)
)
(
graph_contracts_overall_area <- comparison_contracts_area_total %>%
filter(!is.na(SimpleArea) & !SimpleArea %in% c("Unlabeled") &
Fiscal_Year>=1990 ) %>%
mutate(type = factor(type, levels = c("Topline", "Engines"))) %>%
ggplot() +
geom_line(
aes(x = Fiscal_Year,
y = baseline_percent_change,
linetype=SimpleArea),
alpha = .9,
color = "#554449",
size = 1
) +
geom_hline(
yintercept = 0,
alpha = .5,
color = "#554449",
size = .5,
linetype = "dotted"
) +
facet_wrap(~ type) +
chart_theme +
ggtitle("Change in Aircraft Engine Contract Obligations") +
xlab("Fiscal Year") +
ylab("Cumulative Percent Change, Inflation Adjusted (2000=0%)") +
scale_y_continuous(labels = scales::percent, breaks = c(-0.5,0,0.5,1,1.5)) +
scale_x_continuous(
breaks = seq(2000, 2020, by = 2),
labels = function(x) {
substring(as.character(x), 3, 4)
}
)+scale_linetype_manual(
values=c("solid","dotted","dashed")
)
)
(
graph_contracts_overall_area <- comparison_contracts_area_total %>%
filter(!is.na(SimpleArea) & !SimpleArea %in% c("Unlabeled") &
Fiscal.Year>=1990 ) %>%
mutate(type = factor(type, levels = c("Topline", "Engines"))) %>%
ggplot() +
geom_line(
aes(x = Fiscal_Year,
y = baseline_percent_change,
linetype=SimpleArea),
alpha = .9,
color = "#554449",
size = 1
) +
geom_hline(
yintercept = 0,
alpha = .5,
color = "#554449",
size = .5,
linetype = "dotted"
) +
facet_wrap(~ type) +
chart_theme +
ggtitle("Change in Aircraft Engine Contract Obligations") +
xlab("Fiscal Year") +
ylab("Cumulative Percent Change, Inflation Adjusted (2000=0%)") +
scale_y_continuous(labels = scales::percent, breaks = c(-0.5,0,0.5,1,1.5)) +
scale_x_continuous(
breaks = seq(2000, 2020, by = 2),
labels = function(x) {
substring(as.character(x), 3, 4)
}
)+scale_linetype_manual(
values=c("solid","dotted","dashed")
)
)
(
graph_contracts_overall_area <- comparison_contracts_area_total %>%
filter(!is.na(SimpleArea) & !SimpleArea %in% c("Unlabeled") &
Fiscal.Year>=1990 ) %>%
mutate(type = factor(type, levels = c("Topline", "Engines"))) %>%
ggplot() +
geom_line(
aes(x = Fiscal.Year,
y = baseline_percent_change,
linetype=SimpleArea),
alpha = .9,
color = "#554449",
size = 1
) +
geom_hline(
yintercept = 0,
alpha = .5,
color = "#554449",
size = .5,
linetype = "dotted"
) +
facet_wrap(~ type) +
chart_theme +
ggtitle("Change in Aircraft Engine Contract Obligations") +
xlab("Fiscal Year") +
ylab("Cumulative Percent Change, Inflation Adjusted (2000=0%)") +
scale_y_continuous(labels = scales::percent, breaks = c(-0.5,0,0.5,1,1.5)) +
scale_x_continuous(
breaks = seq(2000, 2020, by = 2),
labels = function(x) {
substring(as.character(x), 3, 4)
}
)+scale_linetype_manual(
values=c("solid","dotted","dashed")
)
)
(
graph_contracts_overall_area <- comparison_contracts_area_total %>%
filter(!is.na(SimpleArea) & !SimpleArea %in% c("Services","Unlabeled")&
Fiscal.Year>=2000) %>%
mutate(type = factor(type, levels = c("Topline", "Engines"))) %>%
ggplot() +
geom_line(
aes(x = Fiscal_Year,
y = baseline_percent_change,
linetype=SimpleArea),
alpha = .9,
color = "#554449",
size = 1
) +
geom_hline(
yintercept = 0,
alpha = .5,
color = "#554449",
size = .5,
linetype = "dotted"
) +
facet_wrap(~ type) +
chart_theme +
ggtitle("Change in Aircraft Engine Contract Obligations") +
xlab("Fiscal Year") +
ylab("Cumulative Percent Change, Inflation Adjusted (2000=0%)") +
scale_y_continuous(labels = scales::percent, breaks = c(-0.5,0,0.5,1,1.5)) +
scale_x_continuous(
breaks = seq(2000, 2020, by = 2),
labels = function(x) {
substring(as.character(x), 3, 4)
}
)+scale_linetype_manual(
values=c("solid","dotted","dashed")
)
)
(
graph_contracts_overall_area <- comparison_contracts_area_total %>%
filter(!is.na(SimpleArea) & !SimpleArea %in% c("Services","Unlabeled")&
Fiscal.Year>=2000) %>%
mutate(type = factor(type, levels = c("Topline", "Engines"))) %>%
ggplot() +
geom_line(
aes(x = Fiscal.Year,
y = baseline_percent_change,
linetype=SimpleArea),
alpha = .9,
color = "#554449",
size = 1
) +
geom_hline(
yintercept = 0,
alpha = .5,
color = "#554449",
size = .5,
linetype = "dotted"
) +
facet_wrap(~ type) +
chart_theme +
ggtitle("Change in Aircraft Engine Contract Obligations") +
xlab("Fiscal Year") +
ylab("Cumulative Percent Change, Inflation Adjusted (2000=0%)") +
scale_y_continuous(labels = scales::percent, breaks = c(-0.5,0,0.5,1,1.5)) +
scale_x_continuous(
breaks = seq(2000, 2020, by = 2),
labels = function(x) {
substring(as.character(x), 3, 4)
}
)+scale_linetype_manual(
values=c("solid","dotted","dashed")
)
)
(
graph_contracts_overall_area <- comparison_contracts_area_total %>%
filter(!is.na(SimpleArea) & !SimpleArea %in% c("Services","Unlabeled")&
Fiscal.Year>=2000) %>%
mutate(type = factor(type, levels = c("Topline", "Engines"))) %>%
ggplot() +
geom_line(
aes(x = Fiscal.Year,
y = baseline_percent_change,
linetype=SimpleArea),
alpha = .9,
color = "#554449",
size = 1
) +
geom_hline(
yintercept = 0,
alpha = .5,
color = "#554449",
size = .5,
linetype = "dotted"
) +
facet_wrap(~ type) +
chart_theme +
ggtitle("Change in Aircraft Engine Contract Obligations") +
xlab("Fiscal Year") +
ylab("Cumulative Percent Change, Inflation Adjusted (2000=0%)") +
scale_y_continuous(labels = scales::percent, breaks = c(-0.5,0,0.5,1,1.5)) +
scale_x_continuous(
breaks = seq(2000, 2020, by = 2),
labels = function(x) {
substring(as.character(x), 3, 4)
}
)+scale_linetype_manual(
values=c("solid","dotted","dashed")
)
)
(
graph_contracts_overall_area <- comparison_contracts_area_total %>%
filter(!is.na(SimpleArea) & !SimpleArea %in% c("Services","Unlabeled")&
Fiscal.Year>=2000) %>%
mutate(type = factor(type, levels = c("Topline", "Engines"))) %>%
ggplot() +
geom_line(
aes(x = Fiscal.Year,
y = baseline_percent_change,
linetype=SimpleArea),
alpha = .9,
color = "#554449",
size = 1
) +
geom_hline(
yintercept = 0,
alpha = .5,
color = "#554449",
size = .5,
linetype = "dotted"
) +
facet_wrap(~ type) +
chart_theme +
ggtitle("Change in Aircraft Engine Contract Obligations") +
xlab("Fiscal Year") +
ylab("Cumulative Percent Change, Inflation Adjusted (2000=0%)") +
scale_y_continuous(labels = scales::percent, breaks = c(-0.5,0,0.5,1,1.5)) +
scale_x_continuous(
breaks = seq(2000, 2020, by = 2),
labels = function(x) {
substring(as.character(x), 3, 4)
}
)+scale_linetype_manual(
values=c("solid","dotted","dashed")
)
)
source("F:/Users/gsanders/Documents/Repositories/Engines/contracts/contract_analysis.r", echo=TRUE)
source("F:/Users/gsanders/Documents/Repositories/Engines/contracts/contract_analysis.r", echo=TRUE)
View(topline_contracts)
(
ToplineVendor<-build_plot(
data=engine_contracts %>% filter(Fiscal_Year<=2020),
chart_geom = "Bar Chart",
share = FALSE,
labels_and_colors=labels_and_colors,
# NA, #VAR.ncol
x_var="dFYear", #x_var
y_var="Action_Obligation_OMB23_GDP21", #VAR.y.variable
color_var="Shiny.VendorSize", #color_var
# facet_var="Competition.sum", #facet_var
column_key=column_key,
format=TRUE,
ytextposition=FALSE
)+scale_x_date("Fiscal Year",labels = date_format("'%y"),date_breaks = "2 years")+
# theme(strip.text.y = element_text(angle=0))+
# theme(axis.text.x = element_text(angle=90))+
#    scale_y_continuous("Percent of Obligations", labels = percent_format(accuracy=1))+
#      facet_grid(.~Competition.sum ,scales="free_x", space="free_x"
#             )+labs(title=NULL,
# x="Fiscal Year",
# y="Percent of Obligations",
# color="Competition")+
theme(legend.position = "right")+
labs(y="Obligations (Constant 2021 $s)",
caption="Source: FPDS; CSIS analysis.\nNote: The merger of Raytheon and United Technologies took place in April 2020 and thus did not make the cutofff for inclusion in FY2020.")
)
(
ToplineVendor_line<-build_plot(
data=engine_contracts %>% filter(Fiscal_Year<=2020),
chart_geom = "Line Chart",
labels_and_colors=labels_and_colors,
# NA, #VAR.ncol
x_var="dFYear", #x_var
y_var="Action_Obligation_OMB23_GDP21", #VAR.y.variable
color_var="Shiny.VendorSize", #color_var
# facet_var="Competition.sum", #facet_var
column_key=column_key,
format=TRUE,
ytextposition=FALSE,
share=TRUE
)+scale_x_date("Fiscal Year",labels = date_format("'%y"))+
# theme(strip.text.y = element_text(angle=0))+
# theme(axis.text.x = element_text(angle=90))+
#    scale_y_continuous("Percent of Obligations", labels = percent_format(accuracy=1))+
#      facet_grid(.~Competition.sum ,scales="free_x", space="free_x"
#             )+labs(title=NULL,
# x="Fiscal Year",
# y="Percent of Obligations",
# color="Competition")+
theme(legend.position = "right")+
labs(y="Obligations (Constant 2021 $s)",caption="Source: FPDS; CSIS analysis.\nNote: The merger of Raytheon and United Technologies took place in April of 2020\n and thus did not make the cutofff for inclusion in FY2020.")
)
ggsave600dpi("..//Output//topline_vendor_wide.png", ToplineVendor+
labs(y="Obligations (Constant 2021 $s)",caption="Source: FPDS; CSIS analysis.\nNote: The merger of Raytheon and United Technologies took place in April 2020 and thus did not make the cutofff for inclusion in FY2020."),
width=12, height= 6, units="in",size=12,lineheight=1
)
(
ToplineVendor<-build_plot(
data=engine_contracts %>% filter(Fiscal_Year<=2020),
chart_geom = "Bar Chart",
share = FALSE,
labels_and_colors=labels_and_colors,
# NA, #VAR.ncol
x_var="dFYear", #x_var
y_var="Action_Obligation_OMB23_GDP21", #VAR.y.variable
color_var="Shiny.VendorSize", #color_var
# facet_var="Competition.sum", #facet_var
column_key=column_key,
format=TRUE,
ytextposition=FALSE
)+scale_x_date("Fiscal Year",labels = date_format("'%y"),date_breaks = "2 years")+
# theme(strip.text.y = element_text(angle=0))+
# theme(axis.text.x = element_text(angle=90))+
#    scale_y_continuous("Percent of Obligations", labels = percent_format(accuracy=1))+
#      facet_grid(.~Competition.sum ,scales="free_x", space="free_x"
#             )+labs(title=NULL,
# x="Fiscal Year",
# y="Percent of Obligations",
# color="Competition")+
theme(legend.position = "right")+
labs(y="Obligations (Constant 2021 $s)",
caption="Source: FPDS; CSIS analysis.\nNote: The merger of Raytheon and United Technologies took place in April 2020 and thus did not make the cutofff for inclusion in FY2020.")
)
(
ToplineVendor<-build_plot(
data=engine_contracts %>% filter(Fiscal_Year<=2020),
chart_geom = "Bar Chart",
share = FALSE,
labels_and_colors=labels_and_colors,
# NA, #VAR.ncol
x_var="dFYear", #x_var
y_var="Action_Obligation_OMB23_GDP21", #VAR.y.variable
color_var="Shiny.VendorSize", #color_var
facet_var="SubCustomer.JPO", #facet_var
column_key=column_key,
format=TRUE,
ytextposition=FALSE
)+scale_x_date("Fiscal Year",labels = date_format("'%y"),date_breaks = "2 years")+
# theme(strip.text.y = element_text(angle=0))+
# theme(axis.text.x = element_text(angle=90))+
#    scale_y_continuous("Percent of Obligations", labels = percent_format(accuracy=1))+
#      facet_grid(.~Competition.sum ,scales="free_x", space="free_x"
#             )+labs(title=NULL,
# x="Fiscal Year",
# y="Percent of Obligations",
# color="Competition")+
theme(legend.position = "right")+
labs(y="Obligations (Constant 2021 $s)",
caption="Source: FPDS; CSIS analysis.\nNote: The merger of Raytheon and United Technologies took place in April 2020 and thus did not make the cutofff for inclusion in FY2020.")
)
(
ToplineVendor<-build_plot(
data=engine_contracts %>% filter(Fiscal_Year<=2020 &
SubCustomer.JPO %in% c("Army","Navy","Air Force","DLA","F-35 JPO")),
chart_geom = "Bar Chart",
share = FALSE,
labels_and_colors=labels_and_colors,
# NA, #VAR.ncol
x_var="dFYear", #x_var
y_var="Action_Obligation_OMB23_GDP21", #VAR.y.variable
color_var="Shiny.VendorSize", #color_var
facet_var="SubCustomer.JPO", #facet_var
column_key=column_key,
format=TRUE,
ytextposition=FALSE
)+scale_x_date("Fiscal Year",labels = date_format("'%y"),date_breaks = "2 years")+
# theme(strip.text.y = element_text(angle=0))+
# theme(axis.text.x = element_text(angle=90))+
#    scale_y_continuous("Percent of Obligations", labels = percent_format(accuracy=1))+
#      facet_grid(.~Competition.sum ,scales="free_x", space="free_x"
#             )+labs(title=NULL,
# x="Fiscal Year",
# y="Percent of Obligations",
# color="Competition")+
theme(legend.position = "right")+
labs(y="Obligations (Constant 2021 $s)",
caption="Source: FPDS; CSIS analysis.\nNote: The merger of Raytheon and United Technologies took place in April 2020 and thus did not make the cutofff for inclusion in FY2020.")
)
(
ToplineVendor<-build_plot(
data=engine_contracts %>% filter(Fiscal_Year<=2020 &
SubCustomer.JPO %in% c("Army","Navy","Air Force","DLA","F-35 JPO")),
chart_geom = "Bar Chart",
share = FALSE,
labels_and_colors=labels_and_colors,
# NA, #VAR.ncol
x_var="dFYear", #x_var
y_var="Action_Obligation_OMB23_GDP21", #VAR.y.variable
color_var="Shiny.VendorSize", #color_var
facet_var="SubCustomer.JPO", #facet_var
column_key=column_key,
format=TRUE,
ytextposition=FALSE
)+scale_x_date("Fiscal Year",labels = date_format("'%y"),date_breaks = "2 years")+
# theme(strip.text.y = element_text(angle=0))+
# theme(axis.text.x = element_text(angle=90))+
#    scale_y_continuous("Percent of Obligations", labels = percent_format(accuracy=1))+
#      facet_grid(.~Competition.sum ,scales="free_x", space="free_x"
#             )+labs(title=NULL,
# x="Fiscal Year",
# y="Percent of Obligations",
# color="Competition")+
theme(legend.position = "right")+
labs(y="Obligations (Constant 2021 $s)",
caption="Source: FPDS; CSIS analysis.\nNote: The merger of Raytheon and United Technologies took place in April 2020 and thus did not make the cutofff for inclusion in FY2020.")
)
ggsave600dpi("charts//topline_vendor.png", ToplineVendor,
width=6.5, height= 9, units="in",size=11,lineheight=1
)
#
ggsave600dpi("charts//topline_vendor.png", ToplineVendor,
width=9, height= 6, units="in",size=11,lineheight=1
)
